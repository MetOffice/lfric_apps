@@ -23,7 +23,8 @@
   public :: adj_strong_curl_code
 
   contains
-  subroutine adj_strong_curl_code(nlayers, xi, u, ndf2, undf2, map2, basis_w2, ndf1, undf1, map1, diff_basis_w1)
+  subroutine adj_strong_curl_code(nlayers, xi, u, ndf2, undf2, map2, basis_w2, basis_w2_on_w1, &
+&ndf1, undf1, map1, diff_basis_w1, diff_basis_w1_on_w1)
     integer(kind=i_def), intent(in) :: nlayers
     integer(kind=i_def), intent(in) :: ndf1
     integer(kind=i_def), intent(in) :: undf1
@@ -32,7 +33,9 @@
     integer(kind=i_def), dimension(ndf1), intent(in) :: map1
     integer(kind=i_def), dimension(ndf2), intent(in) :: map2
     real(kind=r_def), dimension(3,ndf2,ndf2), intent(in) :: basis_w2
+    real(kind=r_def), dimension(3,ndf2,ndf1), intent(in) :: basis_w2_on_w1
     real(kind=r_def), dimension(3,ndf1,ndf2), intent(in) :: diff_basis_w1
+    real(kind=r_def), dimension(3,ndf1,ndf1), intent(in) :: diff_basis_w1_on_w1
     real(kind=r_def), dimension(undf2), intent(inout) :: xi
     real(kind=r_def), dimension(undf1), intent(inout) :: u
     integer(kind=i_def) :: df1
