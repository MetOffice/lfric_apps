@@ -11,7 +11,7 @@
                               GH_FIELD, GH_OPERATOR, &
                               GH_READ, GH_INC,       &
                               GH_REAL, CELL_COLUMN
-use constants_mod,     only : r_solver, i_def
+use constants_mod,     only : r_def, i_def
 use kernel_mod,        only : kernel_type
 use fs_continuity_mod, only : W2, W3, Wtheta
 
@@ -98,21 +98,22 @@
   integer(kind=i_def), dimension(ndf_w3), intent(in) :: map_w3
 
   ! Fields
-  real(kind=r_solver), dimension(undf_w2), intent(inout) :: lhs_u
-  real(kind=r_solver), dimension(undf_w2), intent(in)    :: wind, norm_u
-  real(kind=r_solver), dimension(undf_wt), intent(in)    :: theta
-  real(kind=r_solver), dimension(undf_w3), intent(in)    :: exner
+  real(kind=r_def), dimension(undf_w2), intent(inout) :: lhs_u
+  real(kind=r_def), dimension(undf_w2), intent(in)    :: wind, norm_u
+  real(kind=r_def), dimension(undf_wt), intent(in)    :: theta
+  real(kind=r_def), dimension(undf_w3), intent(in)    :: exner
 
   ! Operators
-  real(kind=r_solver), dimension(ndf_w2, ndf_w2, ncell1), intent(in) :: mu_cd
-  real(kind=r_solver), dimension(ndf_w2, ndf_wt, ncell2), intent(in) :: p2theta
-  real(kind=r_solver), dimension(ndf_w2, ndf_w3, ncell3), intent(in) :: grad
+  real(kind=r_def), dimension(ndf_w2, ndf_w2, ncell1), intent(in) :: mu_cd
+  real(kind=r_def), dimension(ndf_w2, ndf_wt, ncell2), intent(in) :: p2theta
+  real(kind=r_def), dimension(ndf_w2, ndf_w3, ncell3), intent(in) :: grad
 
   ! Internal variables
-  integer(kind=i_def)                    :: df, k, ik
-  real(kind=r_solver), dimension(ndf_w2) :: u_e, lhs_e
-  real(kind=r_solver), dimension(ndf_wt) :: t_e
-  real(kind=r_solver), dimension(ndf_w3) :: p_e
+  integer(kind=i_def)                 :: df, k, ik
+  real(kind=r_def), dimension(ndf_w2) :: u_e, lhs_e
+  real(kind=r_def), dimension(ndf_wt) :: t_e
+  real(kind=r_def), dimension(ndf_w3) :: p_e
+  real(kind=r_def), dimension(ndf_w2) :: mucd_ue, p2t_te, grad_pe
 
   do k = 0, nlayers-1
     do df = 1, ndf_w2
@@ -128,9 +129,10 @@
     ik = (cell-1)*nlayers + k + 1
 
     ! lhs_u for this element
-    lhs_e = matmul(mu_cd(:,:,ik), u_e)   &
-          - matmul(p2theta(:,:,ik), t_e) &
-          - matmul(grad(:,:,ik), p_e)
+    mucd_ue = matmul(mu_cd(:,:,ik), u_e)
+    p2t_te = matmul(p2theta(:,:,ik), t_e)
+    grad_pe = matmul(grad(:,:,ik), p_e)
+    lhs_e = mucd_ue  - p2t_te - grad_pe
     do df = 1, ndf_w2
       lhs_u(map_w2(df)+k) = lhs_u(map_w2(df)+k) &
                           + norm_u(map_w2(df)+k)*lhs_e(df)
